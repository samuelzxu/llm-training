isc_project_id = "prj-beautiful-plucky-amount-250802"
experiment_name = "acc-int-tst"
gpus = 12
compute_mode = "cycle"
dataset_id_list = ["uds-three-pale-accelerator-250802", "uds-brazen-meowing-munchkin-250513", "uds-leaf-various-bosworth-250513"]
command = '''
source /root/LLM-Workshop/accel/bin/activate && 
echo "MASTER_PORT: $MASTER_PORT" &&
echo "MASTER_ADDR: $MASTER_ADDR" &&
echo "RANK: $RANK" &&
echo "NNODES: $NNODES" &&
echo "N_PROC: $N_PROC" &&
CONFIG_FILE="/root/LLM-Workshop/chat_assistant/sft/training/configs/deepspeed_config_z3_qlora.yaml" &&
sed -i "s/^main_process_ip:.*/main_process_ip: $MASTER_ADDR/" "$CONFIG_FILE" &&
sed -i "s/^main_process_port:.*/main_process_port: $MASTER_PORT/" "$CONFIG_FILE" &&
sed -i "s/^machine_rank:.*/machine_rank: $RANK/" "$CONFIG_FILE" &&
sed -i "s/^num_machines:.*/num_machines: $NNODES/" "$CONFIG_FILE" &&
sed -i "s/^num_processes:.*/num_processes: $N_PROC/" "$CONFIG_FILE" &&
cat "$CONFIG_FILE" &&
./root/LLM-Workshop/chat_assistant/sft/training/launch.sh
'''
